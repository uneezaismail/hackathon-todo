apiVersion: v1
kind: Secret
metadata:
  name: {{ include "todo-app.fullname" . }}-secrets
  labels:
    {{- include "todo-app.labels" . | nindent 4 }}
    app.kubernetes.io/component: secrets
type: Opaque
data:
  # Database connection string
  {{- if .Values.secrets.DATABASE_URL }}
  DATABASE_URL: {{ .Values.secrets.DATABASE_URL | b64enc | quote }}
  {{- end }}

  # JWT signing secret
  {{- if .Values.secrets.BETTER_AUTH_SECRET }}
  BETTER_AUTH_SECRET: {{ .Values.secrets.BETTER_AUTH_SECRET | b64enc | quote }}
  {{- end }}

  # LLM API keys (at least one required)
  {{- if .Values.secrets.OPENAI_API_KEY }}
  OPENAI_API_KEY: {{ .Values.secrets.OPENAI_API_KEY | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.OPENROUTER_API_KEY }}
  OPENROUTER_API_KEY: {{ .Values.secrets.OPENROUTER_API_KEY | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.GROQ_API_KEY }}
  GROQ_API_KEY: {{ .Values.secrets.GROQ_API_KEY | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.GEMINI_API_KEY }}
  GEMINI_API_KEY: {{ .Values.secrets.GEMINI_API_KEY | b64enc | quote }}
  {{- end }}

  # Cloudflare R2 credentials (optional)
  {{- if .Values.secrets.CLOUDFLARE_R2_ACCOUNT_ID }}
  CLOUDFLARE_R2_ACCOUNT_ID: {{ .Values.secrets.CLOUDFLARE_R2_ACCOUNT_ID | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.CLOUDFLARE_R2_ACCESS_KEY_ID }}
  CLOUDFLARE_R2_ACCESS_KEY_ID: {{ .Values.secrets.CLOUDFLARE_R2_ACCESS_KEY_ID | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.CLOUDFLARE_R2_SECRET_ACCESS_KEY }}
  CLOUDFLARE_R2_SECRET_ACCESS_KEY: {{ .Values.secrets.CLOUDFLARE_R2_SECRET_ACCESS_KEY | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.CLOUDFLARE_R2_BUCKET_NAME }}
  CLOUDFLARE_R2_BUCKET_NAME: {{ .Values.secrets.CLOUDFLARE_R2_BUCKET_NAME | b64enc | quote }}
  {{- end }}
